import{r as x,q as _,aX as C,V as S,x as i,z as t,R as g,aW as p,u as d,J as f,av as L,L as U,P as w,O as n,y as a}from"./vue-vendor-K9KD2h4K.js";import{_ as R,c as z,b as V,s as I}from"./index-DIEkh06s.js";import{T as B}from"./ThemeToggle-DQLuCzR6.js";import"./vendor-DITxge4O.js";import"./element-plus-D5qhxq3g.js";const T={class:"relative flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 px-4 py-12"},E={class:"fixed right-4 top-4 z-10"},M={class:"relative z-10 w-full max-w-md space-y-8"},j={class:"glass-morphism rounded-2xl border border-white/10 p-8 shadow-2xl backdrop-blur-xl"},A={key:0,class:"space-y-6"},G={key:1,class:"space-y-6"},N={class:"text-center"},P={key:2,class:"space-y-6"},H={key:0,class:"rounded-xl border border-red-500/20 bg-red-500/10 p-4"},O={class:"text-sm text-red-400"},W=["disabled"],F={key:0,class:"mr-3 h-5 w-5"},$={key:1,class:"mr-3 h-5 w-5",viewBox:"0 0 24 24"},q={class:"border-t border-slate-600 pt-6 text-center"},D={class:"text-slate-400"},J=3,X={__name:"UserLoginSocialView",setup(K){const b=C(),s=z(),k=V(),c=x(""),u=x(0);function m(){c.value="",s.clearError()}function l(o){c.value=o,console.error("UserLoginSocial: 登录错误",o)}async function y(){m();try{if(console.log("UserLoginSocial: 开始 Google OAuth 登录"),!s.isClerkReady)throw new Error("社交登录系统尚未准备就绪，请稍后重试");await s.signInWithProvider("google",{afterSignInUrl:"/user-dashboard",redirectUrl:"/sso-callback"}),console.log("UserLoginSocial: Google OAuth 登录流程已启动")}catch(o){console.error("UserLoginSocial: Google 登录失败",o),o.message.includes("网络")?l("网络连接错误，请检查网络后重试"):o.message.includes("初始化")||o.message.includes("准备")?l("社交登录系统初始化中，请稍后重试"):o.message.includes("取消")||o.message.includes("cancelled")?l("登录已取消"):l("登录失败，请重试或使用传统登录方式"),u.value++,u.value>=J&&setTimeout(()=>{I("多次登录失败，建议使用传统登录方式","warning"),b.push("/user-login")},2e3)}}return _(async()=>{if(console.log("UserLoginSocial: 页面挂载"),k.isAuthenticated){console.log("UserLoginSocial: 用户已登录，重定向到仪表板"),b.replace("/user-dashboard");return}const e=new URLSearchParams(window.location.search).get("error");if(e){l(decodeURIComponent(e));const r=window.location.pathname;window.history.replaceState({},document.title,r)}u.value=0,setTimeout(()=>{try{console.log("UserLoginSocial: 尝试初始化 Clerk"),s.initializeClerk();let r=0;const h=25,v=()=>{if(r++,console.log(`UserLoginSocial: 检查 Clerk 状态 (${r}/${h})`,{isClerkReady:s.isClerkReady,isClerkLoading:s.isClerkLoading}),s.isClerkReady){console.log("UserLoginSocial: Clerk 已成功初始化");return}if(r>=h){console.warn("UserLoginSocial: Clerk 初始化超时"),l("社交登录系统初始化超时，请刷新页面重试或使用传统登录方式");return}setTimeout(v,200)};v()}catch(r){console.error("UserLoginSocial: Clerk 初始化失败",r),l("社交登录系统初始化失败，请使用传统登录方式")}},500)}),S(()=>{m()}),(o,e)=>{const r=L("RouterLink");return a(),i("div",T,[e[10]||(e[10]=t("div",{class:"absolute inset-0 bg-[radial-gradient(circle_at_50%_120%,rgba(120,119,198,0.1),rgba(255,255,255,0))]"},null,-1)),t("div",E,[g(B,{mode:"dropdown"})]),t("div",M,[e[8]||(e[8]=p('<div class="text-center" data-v-1822b518><div class="mx-auto mb-6 flex h-12 w-12 items-center justify-center rounded-full bg-blue-500" data-v-1822b518><svg class="h-6 w-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-1822b518><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" data-v-1822b518></path></svg></div><h1 class="text-2xl font-bold text-white" data-v-1822b518>ViliCode</h1></div>',1)),t("div",j,[e[7]||(e[7]=t("div",{class:"mb-8 text-center"},[t("h2",{class:"mb-2 text-3xl font-bold text-white"},"欢迎回来"),t("p",{class:"text-slate-400"},"登录您的账户，继续 AI 编程之旅")],-1)),d(s).isClerkLoading?(a(),i("div",A,e[0]||(e[0]=[t("div",{class:"text-center"},[t("div",{class:"mx-auto mb-4 h-8 w-8 animate-spin rounded-full border-4 border-blue-500 border-t-transparent"}),t("p",{class:"text-slate-400"},"正在初始化登录系统...")],-1)]))):d(s).isClerkReady?(a(),i("div",P,[c.value?(a(),i("div",H,[t("p",O,w(c.value),1)])):U("",!0),t("button",{class:"social-btn google-btn flex w-full items-center justify-center rounded-xl border border-white/10 bg-white/5 px-6 py-4 font-medium text-white transition-all duration-200 hover:scale-105 hover:border-white/20 hover:bg-white/10 disabled:cursor-not-allowed disabled:opacity-50",disabled:d(s).isSigningIn,onClick:y},[d(s).isSigningIn?(a(),i("div",F,e[3]||(e[3]=[t("div",{class:"h-5 w-5 animate-spin rounded-full border-2 border-white/30 border-t-white"},null,-1)]))):(a(),i("svg",$,e[4]||(e[4]=[t("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"},null,-1),t("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"},null,-1),t("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"},null,-1),t("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"},null,-1)]))),n(" "+w(d(s).isSigningIn?"正在登录...":"使用 Google 账号登录"),1)],8,W),t("div",q,[t("p",D,[e[6]||(e[6]=n(" 或者 ",-1)),g(r,{class:"font-medium text-blue-400 hover:text-blue-300",to:"/user-login"},{default:f(()=>e[5]||(e[5]=[n("使用用户名密码登录",-1)])),_:1,__:[5]})])])])):(a(),i("div",G,[t("div",N,[e[2]||(e[2]=p('<div class="mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-yellow-500/20" data-v-1822b518><svg class="h-6 w-6 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-1822b518><path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" data-v-1822b518></path></svg></div><h3 class="mb-2 font-medium text-white" data-v-1822b518>社交登录暂时不可用</h3><p class="mb-6 text-slate-400" data-v-1822b518>登录系统正在初始化中，请稍后重试或使用传统登录</p>',3)),g(r,{class:"inline-flex items-center rounded-lg bg-blue-600 px-4 py-2 font-medium text-white transition-colors hover:bg-blue-700",to:"/user-login"},{default:f(()=>e[1]||(e[1]=[n(" 使用传统登录 ",-1)])),_:1,__:[1]})])]))]),e[9]||(e[9]=t("div",{class:"text-center"},[t("p",{class:"text-xs text-slate-500"},[n(" 登录即表示您同意我们的 "),t("a",{class:"text-blue-400 hover:text-blue-300",href:"#"},"服务条款"),n(" 和 "),t("a",{class:"text-blue-400 hover:text-blue-300",href:"#"},"隐私政策")])],-1))])])}}},se=R(X,[["__scopeId","data-v-1822b518"]]);export{se as default};
